var _e=Object.defineProperty,ve=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var ae=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable;var oe=(g,v,u)=>v in g?_e(g,v,{enumerable:!0,configurable:!0,writable:!0,value:u}):g[v]=u,U=(g,v)=>{for(var u in v||(v={}))ce.call(v,u)&&oe(g,u,v[u]);if(ae)for(var u of ae(v))ge.call(v,u)&&oe(g,u,v[u]);return g},E=(g,v)=>ve(g,fe(v));var O=(g,v,u)=>new Promise((A,w)=>{var l=m=>{try{_(u.next(m))}catch(i){w(i)}},N=m=>{try{_(u.throw(m))}catch(i){w(i)}},_=m=>m.done?A(m.value):Promise.resolve(m.value).then(l,N);_((u=u.apply(g,v)).next())});import{b3 as b,b4 as te,d as ne,h as k,c as we,at as He,a as M,o as S,e as r,A as re,w as t,b as c,b5 as ye,x as Ae,k as De,I as $e,aQ as Re,b6 as ke,s as R,b0 as xe,q as h,b7 as Ne,t as W,f as J,a4 as ie,B as se,aM as de,b8 as Te,M as B,aY as le,_ as ee,aN as Le,aO as Ce,S as Ve,aW as Be,a9 as Se,aa as Ue,y as Ee,z as Oe}from"./index-BLKh9tQK.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{u as qe}from"./loading-CMzUFs6t.js";function Z(g){return b.post(te("/v1/internal"),E(U({},g),{action:"upsert_blog"}))}const Pe={class:"container"},je={class:"wrapper",style:{display:"flex"}},Fe={style:{flex:"7"}},Ge={class:"form-wrapper"},Ie={class:"btns"},We=ne({__name:"edit",props:{blogInfo:{type:Object,default:()=>({})}},emits:["cancelEdit","cancelHandle"],setup(g,{emit:v}){const u=g,A=v,w=k(),l=k({title:"",category:"",author:"",marks:"",content:"",status:"",location:"",release_time:""}),N=k({main_img:""}),_=k({main_img:[]}),m=we(()=>{var e;return!!((e=u.blogInfo)!=null&&e.id)});He(()=>u.blogInfo,e=>{e!=null&&e.id&&(l.value=e,_.value={main_img:e.cover||[]})},{immediate:!0});const i=()=>{A("cancelHandle")},Q=(e,o)=>(console.log("onBeforeUpload:",e),N.value[o]=e.name,!0),z=(e,o)=>{console.log("onBeforeRemove:",e);const p=[];return _.value[o].forEach(f=>{f.indexOf(e.name)===-1&&p.push(f)}),_.value[o]=p,!0},Y=(e,o)=>{const{response:p}=e;_.value[o].push(p.data.file_url),console.log("onUploadSuccess:",e)},y=e=>{console.log("onUploadError:",e)},H=e=>e.map(o=>({name:o,url:Te(o)})),x=o=>O(this,[o],function*({errors:e}){if(!e)try{B.success("保存成功"),A("cancelHandle")}catch(p){B.error(p||"保存失败")}}),a=e=>O(this,null,function*(){var p;const o=Array.isArray(l.value.marks)?l.value.marks:l.value.marks.split(",");if(e){if(console.log("formData:",w),yield(p=w.value)==null?void 0:p.validate()){B.error("填写内容有误，请检查");return}le.confirm({title:"发布文章",content:"是否确认发布文章？",titleAlign:"start",onOk:()=>{Z(E(U({},l.value),{marks:o,cover:_.value.main_img,status:"online"})).then(n=>{B.success("发布成功"),i()})},onCanel:()=>{}})}else console.log("formData:",l),Z(E(U({},l.value),{cover:_.value.main_img,marks:o,status:l.value.status?l.value.status:"offline"})).then(f=>{B.success("保存成功"),i()})}),s=()=>O(this,null,function*(){var p;console.log("formData:",l);const e=Array.isArray(l.value.marks)?l.value.marks:l.value.marks.split(",");if(yield(p=w.value)==null?void 0:p.validate()){B.error("填写内容有误，请检查");return}le.confirm({title:"撤回文章",content:"是否确认撤回文章？",titleAlign:"start",onOk:()=>{Z(E(U({},l.value),{marks:e,cover:_.value.main_img,status:"offline"})).then(f=>{B.success("撤回成功"),i()})},onCanel:()=>{}})});return(e,o)=>{const p=re("Breadcrumb"),f=$e,n=De,D=ke,T=Re,L=xe,C=Ae,$=se,V=de;return S(),M("div",Pe,[r(p,{items:["数据管理",m.value?"编辑文章":"创建文章"]},null,8,["items"]),r(V,{class:"general-card"},{title:t(()=>[R(W(m.value?"编辑文章":"创建文章"),1)]),default:t(()=>[c("div",je,[c("div",Fe,[r(ye,{modelValue:l.value.content,"onUpdate:modelValue":o[0]||(o[0]=d=>l.value.content=d),init:{plugins:"preview",toolbar:"undo redo | formatselect | bold italic | alignleft aligncenter alignright | preview"}},null,8,["modelValue"])]),c("div",Ge,[r(C,{ref_key:"formRef",ref:w,model:l.value,"label-align":"left","auto-label-width":"",onSubmit:x},{default:t(()=>[r(n,{field:"title",label:"标题",rules:[{required:!0}]},{default:t(()=>[r(f,{modelValue:l.value.title,"onUpdate:modelValue":o[1]||(o[1]=d=>l.value.title=d),placeholder:"请输入标题","allow-clear":""},null,8,["modelValue"])]),_:1}),r(n,{field:"author",label:"作者",rules:[{required:!0}]},{default:t(()=>[r(f,{modelValue:l.value.author,"onUpdate:modelValue":o[2]||(o[2]=d=>l.value.author=d),placeholder:"请输入作者","allow-clear":""},null,8,["modelValue"])]),_:1}),r(n,{field:"category",label:"文章类别",rules:[{required:!0}]},{default:t(()=>[r(T,{modelValue:l.value.category,"onUpdate:modelValue":o[3]||(o[3]=d=>l.value.category=d),placeholder:"请选择文章类别"},{default:t(()=>[r(D,null,{default:t(()=>o[9]||(o[9]=[R("Company")])),_:1}),r(D,null,{default:t(()=>o[10]||(o[10]=[R("Business")])),_:1}),r(D,null,{default:t(()=>o[11]||(o[11]=[R("Products")])),_:1}),r(D,null,{default:t(()=>o[12]||(o[12]=[R("Developers")])),_:1})]),_:1},8,["modelValue"])]),_:1}),r(n,{field:"marks",label:"标签",rules:[{required:!0}]},{default:t(()=>[r(f,{modelValue:l.value.marks,"onUpdate:modelValue":o[4]||(o[4]=d=>l.value.marks=d),placeholder:"请输入标签，多个标签用,分隔","allow-clear":""},null,8,["modelValue"])]),_:1}),r(n,{field:"main_img",label:"封面图","row-class":"keep-margin",rules:[{required:!1,message:"封面图不能为空"}]},{default:t(()=>[c("div",null,[r(L,{"list-type":"picture-card","image-preview":"",action:h(te)("/v1/internal"),headers:{Authorization:`Bearer ${h(Ne)()}`},limit:1,accept:"image/png, image/jpeg, image/jpg",data:{action:"upload",filename:N.value.main_img},"default-file-list":H(_.value.main_img),"on-before-upload":d=>Q(d,"main_img"),"on-before-remove":d=>z(d,"main_img"),onSuccess:o[5]||(o[5]=d=>Y(d,"main_img")),onError:y},null,8,["action","headers","data","default-file-list","on-before-upload","on-before-remove"]),o[13]||(o[13]=c("div",{style:{"font-size":"12px","margin-top":"5px"}},"支持上传格式：PNG、JPG，文件大小不得超过20MB。",-1))])]),_:1}),r(n,{field:"location",label:"文章路径",rules:[{required:!0}]},{default:t(()=>[r(f,{modelValue:l.value.location,"onUpdate:modelValue":o[6]||(o[6]=d=>l.value.location=d),placeholder:"文章id，例：robot-develop"},null,8,["modelValue"])]),_:1}),r(n,{field:"status",label:"状态"},{default:t(()=>[c("div",null,W(l.value.status==="online"?"已发布":"草稿"),1)]),_:1}),r(n,{field:"publishTime",label:"发布时间"},{default:t(()=>[c("div",null,W(l.value.release_time||"-"),1)]),_:1})]),_:1},8,["model"]),c("div",Ie,[l.value.status!=="online"?(S(),J($,{key:0,type:"primary",onClick:o[7]||(o[7]=()=>{a(!0)})},{default:t(()=>o[14]||(o[14]=[R(" 发布 ")])),_:1})):(S(),J($,{key:1,type:"outline",onClick:s},{default:t(()=>o[15]||(o[15]=[R("撤回")])),_:1})),l.value.status!=="offline"?(S(),J($,{key:2,type:"outline",onClick:o[8]||(o[8]=()=>{a(!1)})},{default:t(()=>o[16]||(o[16]=[R(" 保存 ")])),_:1})):ie("",!0),r($,{class:"cancel-btn",onClick:i},{default:t(()=>o[17]||(o[17]=[R("取消")])),_:1})])])])]),_:1})])}}}),ze=ee(We,[["__scopeId","data-v-e54b59ed"]]),Je={class:"container"},Qe=["innerHTML"],Ye=["innerHTML"],Ke=["innerHTML"],Xe=["innerHTML"],Ze=["innerHTML"],be=["innerHTML"],he=["innerHTML"],Me=["innerHTML"],ea={style:{color:"#005aff"}},aa=ne({__name:"list",emits:["doHandle"],setup(g,{emit:v}){k("medium");const u=k(""),A=k([]),w=k([]),l=[{title:"主队 vs 客队",dataIndex:"teamName",width:100},{title:"让球",dataIndex:"handicap",slotName:"handicap"},{title:"支持率（胜）",dataIndex:"winRate",slotName:"winRate"},{title:"支持率（平）",dataIndex:"drawRate",slotName:"drawRate"},{title:"支持率（负）",dataIndex:"loseRate",slotName:"loseRate"},{title:"分投注",dataIndex:"costAnd",slotName:"costAnd"},{title:"总投注",dataIndex:"totalCostAnd",slotName:"totalCostAnd"},{title:"穿盘",dataIndex:"through"},{title:"1个",dataIndex:"winOne"},{title:"平",dataIndex:"drawGame"},{title:"下赢",dataIndex:"loseGame"}],{loading:N,setLoading:_}=qe(!0),m=(y,H)=>(y*(H-1)).toFixed(0),i=y=>Number(y)||0,Q=y=>O(this,null,function*(){const H=yield b.get("https://webapi.sporttery.cn/gateway/jc/common/getSupportRateV1.qry",{params:{poolCode:"hhad,had",sportType:"1",matchIds:y.map(s=>s.id).join(",")}});console.log(H);const x=H.value,a=A.value.map(s=>{var o,p,f,n,D,T,L,C,$,V,d,q;const e=x[`_${s.id}`];if(e){const P=m((o=e==null?void 0:e.HAD)==null?void 0:o.win,s.hWinRate),K=m((p=e==null?void 0:e.HAD)==null?void 0:p.draw,s.hDrawRate),j=m((f=e==null?void 0:e.HAD)==null?void 0:f.lose,s.hLoseRate),F=m((n=e==null?void 0:e.HHAD)==null?void 0:n.win,s.hhWinRate),X=m((D=e==null?void 0:e.HHAD)==null?void 0:D.draw,s.hhDrawRate),G=m((T=e==null?void 0:e.HHAD)==null?void 0:T.lose,s.hhLoseRate),ue=s.drawNum<0?i(P)+i(F):i(j)+i(G);let I=0;s.drawNum===-1?I=i(P)+i(X):s.drawNum===-2?I=i(P)+i(G):s.drawNum===1?I=i(j)+i(X):s.drawNum===2&&(I=i(j)+i(F));const me=s.drawNum<0?i(K)+i(G):i(K)+i(F),pe=s.drawNum<0?i(j)+i(G):i(P)+i(F);return E(U({},s),{winRate:`(${((L=e==null?void 0:e.HAD)==null?void 0:L.win)||"--"})(${P})<br/>(${((C=e==null?void 0:e.HHAD)==null?void 0:C.win)||"--"})(${F})`,drawRate:`(${(($=e==null?void 0:e.HAD)==null?void 0:$.draw)||"--"})(${K})<br/>(${((V=e==null?void 0:e.HHAD)==null?void 0:V.draw)||"--"})(${X})`,loseRate:`(${((d=e==null?void 0:e.HAD)==null?void 0:d.lose)||"--"})(${j})<br/>(${((q=e==null?void 0:e.HHAD)==null?void 0:q.lose)||"--"})(${G})`,costAnd:`${e.HAD?e.HAD.win+e.HAD.draw+e.HAD.lose:"--"}<br/>${e.HHAD?e.HHAD.win+e.HHAD.draw+e.HHAD.lose:"--"}`,totalCostAnd:`${(e.HAD?e.HAD.win+e.HAD.draw+e.HAD.lose:"")+(e.HHAD?e.HHAD.win+e.HHAD.draw+e.HHAD.lose:"")}`,through:ue,winOne:I,drawGame:me,loseGame:pe})}return s});w.value=a}),z=()=>O(this,null,function*(){var y;_(!0);try{const H=yield b.get("https://webapi.sporttery.cn/gateway/uniform/football/getMatchCalculatorV1.qry",{params:{poolCode:"hhad,had",channel:"c"}});u.value=H.value.lastUpdateTime,(y=H==null?void 0:H.value)==null||y.matchInfoList.forEach(x=>{x==null||x.subMatchList.forEach(a=>{var s,e,o,p,f,n,D,T,L,C,$,V,d,q;A.value.push({id:a.matchId,matchId:a.matchNumStr||"--",matchName:a.leagueAbbName||"--",startTime:`${a.matchDate||"--"} ${a.matchTime||"--"}`,teamName:`${a.homeRank||"--"} ${a.homeTeamAbbName||"--"} vs ${a.awayRank||"--"} ${a.awayTeamAbbName||"--"}`,handicap:`0<br/>${((s=a==null?void 0:a.hhad)==null?void 0:s.goalLine)||"--"}`,win:`${((e=a==null?void 0:a.had)==null?void 0:e.h)||"--"}<br/>${((o=a==null?void 0:a.hhad)==null?void 0:o.h)||"--"}`,draw:`${((p=a==null?void 0:a.had)==null?void 0:p.d)||"--"}<br/>${((f=a==null?void 0:a.hhad)==null?void 0:f.d)||"--"}`,lose:`${((n=a==null?void 0:a.had)==null?void 0:n.a)||"--"}<br/>${((D=a==null?void 0:a.hhad)==null?void 0:D.a)||"--"}`,hWinRate:(T=a==null?void 0:a.had)==null?void 0:T.h,hDrawRate:(L=a==null?void 0:a.had)==null?void 0:L.d,hLoseRate:(C=a==null?void 0:a.had)==null?void 0:C.a,hhWinRate:($=a==null?void 0:a.hhad)==null?void 0:$.h,hhDrawRate:(V=a==null?void 0:a.hhad)==null?void 0:V.d,hhLoseRate:(d=a==null?void 0:a.hhad)==null?void 0:d.a,drawNum:Number((q=a==null?void 0:a.hhad)==null?void 0:q.goalLine)})})}),w.value=A.value,Q(A.value)}catch(H){console.log(H)}finally{_(!1)}}),Y=()=>{z()};return z(),(y,H)=>{const x=re("Breadcrumb"),a=se,s=Ve,e=Ce,o=Le,p=Be,f=de;return S(),M("div",Je,[r(x,{items:["竞彩列表"]}),r(f,{class:"general-card",style:{"padding-top":"20px"}},{default:t(()=>[r(o,{style:{"margin-bottom":"16px"}},{default:t(()=>[r(e,{span:12},{default:t(()=>[r(s,null,{default:t(()=>[r(a,{type:"primary",onClick:Y},{default:t(()=>H[0]||(H[0]=[R("刷新数据")])),_:1})]),_:1})]),_:1}),r(e,{span:12,style:{"text-align":"right"}},{default:t(()=>[c("span",null,"奖金更新时间: "+W(new Date().toLocaleString()),1)]),_:1})]),_:1}),r(p,{"row-key":"id",scroll:{y:600},loading:h(N),columns:l,data:w.value},{handicap:t(({record:n})=>[c("div",{innerHTML:n.handicap},null,8,Qe)]),win:t(({record:n})=>[c("div",{innerHTML:n.win},null,8,Ye)]),draw:t(({record:n})=>[c("div",{innerHTML:n.draw},null,8,Ke)]),lose:t(({record:n})=>[c("div",{innerHTML:n.lose},null,8,Xe)]),winRate:t(({record:n})=>[c("div",{innerHTML:n.winRate},null,8,Ze)]),drawRate:t(({record:n})=>[c("div",{innerHTML:n.drawRate},null,8,be)]),loseRate:t(({record:n})=>[c("div",{innerHTML:n.loseRate},null,8,he)]),costAnd:t(({record:n})=>[c("div",{innerHTML:n.costAnd},null,8,Me)]),totalCostAnd:t(({record:n})=>[c("div",ea,W(n.totalCostAnd),1)]),_:1},8,["loading","data"])]),_:1})])}}}),oa=ee(aa,[["__scopeId","data-v-680cdb87"]]),la={class:"container"},ta={__name:"index",setup(g){const v=localStorage.getItem("username"),u=localStorage.getItem("passwd");((_,m)=>_===Ee&&m===Oe)(v,u)||(window.location.href="/login");const w=k(!1),l=k(null),N=_=>{w.value=!0,l.value=_};return(_,m)=>(S(),M("div",la,[Se(r(oa,{"is-handling":w.value,onDoHandle:N},null,8,["is-handling"]),[[Ue,!w.value]]),w.value?(S(),J(ze,{key:0,"blog-info":l.value,onCancelHandle:m[0]||(m[0]=()=>{w.value=!1})},null,8,["blog-info"])):ie("",!0)]))}},ya=ee(ta,[["__scopeId","data-v-09894086"]]);export{ya as default};
